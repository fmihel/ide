function THREAD(b){return new thread(b)}function thread(b){this.param=$.extend({interval:1,suspend:!0,forced:1,data:{},onstart:void 0,onstop:void 0,onerror:void 0,func:void 0,_timer:-1,_event:"start",_need_stop:!1},"function"===typeof b?{func:b,suspend:!1}:b);this.param.suspend||this.start()}
thread.prototype.start=function(){var b=this,a=b.param;if(a.onstart)a.onstart(a.data,b,"start");a._timer=setInterval(function(){try{for(var c=a.forced;0<c&&!a._need_stop;)a.func(a.data,b,a._event),a._event="loop",c--}catch(d){if(b._stop(),a.onerror)a.onerror(d,b)}if(a._need_stop&&(b._stop(),a.onstop))a.onstop(a.data,b,"stop")},a.interval)};thread.prototype._stop=function(){clearInterval(this.param._timer)};thread.prototype.stop=function(){this.param._need_stop=!0};